
# UUIDs in JSON files

All JSON configuration files must contain a [UUID (universally unique identifier)](https://en.wikipedia.org/wiki/Universally_unique_identifier) to link the on-disk JSON file to the corresponding object in the database. This looks like:

```json
{
    "uuid": "cef0cbf3-6458-4f13-a418-ee4d7e7505dd"
}
```

When you make new questions, assessments, etc, you will need to add a UUID to the the JSON file. These can be generated by [https://www.uuidgenerator.net](https://www.uuidgenerator.net) (the UUID version doesn't matter).

UUIDs in PrairieLearn actually only need to be unique within their enclosing context. For example, every question in a course needs to have a different UUID, but different courses can repeat UUIDs without issue.

## When do you need a new UUID?

As your course is constructed, you may run into scenarios that require you to change the UUID listed within a JSON file. Below, we've listed some common instances of when the UUID should or shouldn't be changed.

* **Editing information within a JSON file: no new UUID needed.** For example, if you add another `Instructor` to a `infoCourseInstance.json`, or delete a question in an `infoAssessment.json`, then you **must not change the UUID**. This is because PrairieLearn uses the UUID to know that it's still the same course instance or assessment and you just want to make a change to it. If you do inadvertently change the UUID in this way, changing it back will revert everything to the way it was with no data loss.

* **Renaming a directory: no new UUID needed.** For example if you rename a question or assessment directory, then you should leave the UUID the same, so that PrairieLearn will know that this is the same object but just with a new name.

* **Moving a directory: no new UUID needed.** For example, if you move an assessment between course instances or if you move a question between courses, you can leave the UUID as is. You can also rename it in this case, but it isn't necessary.

* **Copying a directory: needs a new UUID.** For example, if you copy an existing question or assessment to make a new one, then you will need a new UUID for the new object, so that PrairieLearn can distinguish it from the original.

## Bulk addition of UUIDs

To add a UUID to all the JSON files in a course you can run the included [`generate_uuids.py`](https://github.com/PrairieLearn/PrairieLearn/blob/master/tools/generate_uuids.py) Python script.

This script will add a UUID to the start of every JSON file that doesn't currently have one, so it's safe to run it multiple times. You will then need to commit and push these changes to GitHub.

To use the script, run:

```sh
cd <path_to_PrairieLearn_source_code>
cd tools
python generate_uuids.py <path_to_course_directory>
```

For example, `python generate_uuids.py ~/git/pl-tam212`.

If you're using the Docker container, you can avoid downloading the script by running:

```sh
docker run --rm -v /path/to/course:/course prairielearn/prairielearn python /PrairieLearn/tools/generate_uuids.py /course
```


## Bulk replacement of UUIDs

**Danger warning:** To change all UUIDs in a course, you can use the above `generate_uuids.py` script with the `--new` argument. **This can delete your entire course.**
