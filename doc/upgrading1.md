
# Upgrading to PrairieLearn v2

The course directory layout for PLv2 is:

    exampleCourse
    |-- courseInfo.json # needs to be upgraded (see below)
    |-- questions       # does not change in any way
    `-- courseInstances # replaces the 'tests' directory

## UUIDs

All JSON configuration files must now contain a [UUID (universally unique identifier)](https://en.wikipedia.org/wiki/Universally_unique_identifier) to link the on-disk JSON file to the corresponding object in the database. In PLv1 this linking was done via the directory name, which meant that directories couldn't be renamed without causing problems. In PLv2 the UUID is used for linking so directories can be freely renamed at any time.

To add a UUID to all the JSON files in a course you can run the included `generated_uuids.py` Python script, like this:

    cd <path_to_PrairieLearn>
    cd tools
    python generate_uuids.py <path_to_course_directory>

For example, `python generate_uuids.py ~/git/pl-tam212`.

This script will add a UUID to the start of each JSON file. You will then need to commit and push these changes to github.

When you make new questions, assessments, etc, in the future then you will need to add a UUID to the the JSON file. These can be generated by https://www.uuidgenerator.net (the UUID version doesn't matter).

## Upgrading `courseInfo.json`

FIXME

## Upgrading the `questions` directory

No action is needed for the `questions` directory beyond the UUID addition described above. All questions will continue to work without modification.

## Upgrading the `tests` directory

The `tests` directory is not used by PLv2. It doesn't matter if it is still present, as PLv2 will just ignore it. The information about tests has now shifted to `courseInstances` (see below).

## The new `courseInstances` directory

There is a new directory at the top level called `courseInstances`. The layout of this is:

    exampleCourse
    `-- courseInstances                    # replaces the 'tests' directory
        +-- Fa16                           # one directory per semester
        |   +-- courseInstanceInfo.json    # settings for Fa16 semester
        |   `-- assessments                # all assessments for the Fa16 semester (equivalent to old tests directory)
        |       +-- hw1
        |       |   `-- info.json
        |       `-- hw2
        |           `-- info.json
        `-- Sp17                           # another semester
            +-- courseInstanceInfo.json
            `-- assessments
                +-- hw1                    # it's ok to reuse assessment names in different semesters
                |   `-- info.json
                `-- hw2
                    `-- info.json

## The `courseInstanceInfo.json` files

See the [`courseInstanceInfo.json` documentation](https://github.com/PrairieLearn/PrairieLearn/blob/master/doc/courseInstanceInfo.md). One of these files is required inside every semester directory.

## The `assessments` directory

The `assessments` directory within each course instance is the equivalent of the old `tests` directory. It contains one subdirectory for each assessment. The word `test` has been replace by `assessment` everywhere within PLv2 to be less confusing (`assessments` includes homeworks, or exams, and everything else).

## The assessment `info.json` files

See [writing assessments](https://github.com/PrairieLearn/PrairieLearn/blob/master/doc/writingAssessments.md) for details on the per-assessment `info.json` files. They are almost the same as the per-test `info.json` files from PLv1, with the following changes:

1. FIXME
